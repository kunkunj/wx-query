function e(e){e.prototype.create=function(){return new e},e.create=function(){return new e}}const t=e=>"object"!=typeof e||!Object.keys(e).length,o=function(e){console.warn(e)};function n(e){e.prototype.init=s,e.init=s}function s(e){if(e.createDataKey)throw new Error("请不要取名createDataKey");e.createDataKey=function(e,t,o,n){for(const s in e)if("object"==typeof e[s])o.createDataKey(e[s],t+"$$"+s,o,n+"."+s);else if(["string","number"].includes(typeof e[s])){o.setData({[t+"$$"+s]:e[s]}),Object.defineProperty(o.data,t+"$$"+s,{set(e){let n=(t+"$$"+s).split("$$");if(2==n.length)return void(o.observeData[n[1]]!==e&&(o.observeData[n[1]]=e));let i={};for(let t=1;t<n.length;t++)t<n.length-1?i=o.observeData[n[t]]:i[s]!==e&&(i[s]=e)},get:()=>e[s]});let i=n.split("."),u=o;i.map((e=>{u=u[e]})),e["_"+s]=e[s],Object.defineProperty(u,s,{set(n){e["_"+s]=n,o.setData({[t+"$$"+s]:n})},get:()=>e["_"+s]})}},t(this.plugins)||(e.$keyName?e[e.$keyName]=this.plugins:e.$=this.plugins),e.onReady&&e.onReady(),e.onReady=function(){this.observeData&&this.createDataKey(e.observeData,e.sup||"L",this,"observeData")},Page(e)}function i(e){e.prototype.plugins={},e.plugins={}}function u(e){e.prototype.use=function(t){return Array.isArray(t)?t.map((t=>{t.install?.call(null,e)})):t.install?.call(null,e),e},e.use=function(t){return Array.isArray(t)?t.map((t=>{t.install?.call(null,e)})):t.install?.call(null,e),e}}function c(){}var a;function r(){}a=c,Array.isArray(a)&&a.map((e=>{u(e)})),"function"==typeof a&&u(a),(t=>{Array.isArray(t)&&t.map((t=>{e(t)})),"function"==typeof t&&e(t)})(c),(e=>{Array.isArray(e)&&e.map((e=>{n(e)})),"function"==typeof e&&n(e)})(c),(e=>{Array.isArray(e)&&e.map((e=>{i(e)})),"function"==typeof e&&i(e)})(c),r.prototype.instance=function(){};const h={install(e){e.plugins.$request=r}};function l(){this.stack={currentPage:null,lastPage:null,routes:[]},this.isWatchRouter=!1}(e=>{e.prototype.beforeEach=function(t){var o;"function"!=typeof t&&(o="beforeEach arg not a function",console.error(o)),this.isWatchRouter=!0,e.hooksQuee.quees.push(function(e,t){return{nextPage:!1,reset:function(){this.nextPage=!1},fn:e,execute:function(){this.fn(t.stack.lastPage,t.stack.currentPage,this.next.bind(this))},next:function(){this.nextPage=!0}}}(t,this))}})(l),l.hooksQuee={quees:[],isExcute(){return this.quees.find((e=>!e.nextPage))},reset(){this.quees.map((e=>{e.reset()}))},execute(){this.quees.map((e=>{e.execute()}))}},l.prototype.updateStack=function(){},l.prototype.switchTab=function(e){l.hooksQuee.execute(),l.hooksQuee.isExcute()&&this.isWatchRouter?o("beforeEach hook need to execute next"):l.hooksQuee.isExcute()&&this.isWatchRouter||(console.log("执行成功"),this.isWatchRouter&&l.hooksQuee.reset())},l.prototype.reLaunch=function(e){l.hooksQuee.execute(),l.hooksQuee.isExcute()&&this.isWatchRouter?o("beforeEach hook need to execute next"):l.hooksQuee.isExcute()&&this.isWatchRouter||wx.reLaunch({...e,complete:function(t){this.isWatchRouter&&l.hooksQuee.reset(),e?.complete?.call(wx,t)}})},l.prototype.redirectTo=function(e){l.hooksQuee.execute(),l.hooksQuee.isExcute()&&this.isWatchRouter?o("beforeEach hook need to execute next"):l.hooksQuee.isExcute()&&this.isWatchRouter||wx.redirectTo({...e,complete:function(t){this.isWatchRouter&&l.hooksQuee.reset(),e?.complete?.call(wx,t)}})},l.prototype.navigateTo=function(e){l.hooksQuee.execute(),l.hooksQuee.isExcute()&&this.isWatchRouter?o("beforeEach hook need to execute next"):l.hooksQuee.isExcute()&&this.isWatchRouter||wx.navigateTo({...e,complete:function(t){this.isWatchRouter&&l.hooksQuee.reset(),e?.complete?.call(wx,t)}})},l.prototype.navigateBack=function(e){l.hooksQuee.execute(),l.hooksQuee.isExcute()&&this.isWatchRouter?o("beforeEach hook need to execute next"):l.hooksQuee.isExcute()&&this.isWatchRouter||wx.navigateBack({...e,complete:function(t){this.isWatchRouter&&l.hooksQuee.reset(),e?.complete?.call(wx,t)}})};const f=()=>new l;export{h as WxRequest,f as WxRouter,c as wxPage};
